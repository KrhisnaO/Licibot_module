{% extends 'core/administrador.html' %}

{% block admin_content %}
    <h3 id="coltit">Subir Archivo de Licitación</h3>
    
    {% if messages %}
        {% for message in messages %}
            <div class="alert {{ message.tags }}">{{ message }}</div>
        {% endfor %}
    {% endif %}
    
    <form method="post" enctype="multipart/form-data">
        {% csrf_token %}
        
        <div class="form-group">
            <label for="idLicitacion">ID de Licitación:</label>
            {{ form.idLicitacion }}
        </div>
        
        <div class="form-group">
            <label for="nombreLicitacion">Nombre de Licitación:</label>
            {{ form.nombreLicitacion }}
        </div>
        
        <div class="form-group">
            <label for="archivoLicitacion">Archivo:</label>
            {{ form.archivoLicitacion }}
        </div>
        
        <button type="submit" name="validar" class="btn btn-primary">Validar Archivo</button>
        
        {% if id_encontrado %}
            <input type="hidden" name="validado" value="1">
            <button type="submit" name="guardar" class="btn btn-success">Guardar y Continuar</button>
        {% endif %}
    </form>

    {% if error %}
        <div class="alert alert-danger" role="alert">
            {{ error }}
        </div>
    {% endif %}

    {% if id_encontrado %}
        <div class="alert alert-info" role="alert">
            <h4>Comparación de IDs:</h4>
            <p>ID de Licitación: {{ licitacion.idLicitacion }}</p>
            <p>ID encontrado en el archivo: {{ id_encontrado }}</p>
            {% if licitacion.idLicitacion|stringformat:"s" == id_encontrado %}
                <p class="text-success">Las licitaciones coinciden.</p>
            {% else %}
                <p class="text-danger">Las licitaciones no coinciden.</p>
            {% endif %}
        </div>
    {% endif %}
{% endblock %}
